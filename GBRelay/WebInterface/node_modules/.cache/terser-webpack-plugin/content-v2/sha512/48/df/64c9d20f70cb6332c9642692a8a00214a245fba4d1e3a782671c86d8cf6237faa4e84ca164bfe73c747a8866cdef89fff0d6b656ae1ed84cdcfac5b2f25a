{"code":"(this[\"webpackJsonpgb-relay-web\"]=this[\"webpackJsonpgb-relay-web\"]||[]).push([[0],{13:function(e,t,s){\"use strict\";s.d(t,\"a\",(function(){return o}));const n=e=>new Uint8Array(e.match(/.{1,2}/g).map((e=>parseInt(e,16))));class o{constructor(){this.buffer=[],this.buffer_in=[],this.buffer_out=[],this.send_active=!1}static getPorts(){return navigator.usb.getDevices().then((e=>e))}static requestPort(){return navigator.usb.requestDevice({filters:[{vendorId:9114},{vendorId:51966}]}).then((e=>e))}getEndpoints(e){e.forEach((e=>{e.alternates.forEach((t=>{255===t.interfaceClass&&(console.log(\"Interface number:\"),console.log(e.interfaceNumber),this.ifNum=e.interfaceNumber,t.endpoints.forEach((e=>{\"out\"===e.direction&&(console.log(\"Endpoint out: \"),console.log(e.endpointNumber),this.epOut=e.endpointNumber),\"in\"===e.direction&&(console.log(\"Endpoint in: \"),console.log(e.endpointNumber),this.epIn=e.endpointNumber)})))}))}))}getDevice(){let e=null;return this.ready=!1,new Promise(((t,s)=>{o.requestPort().then((t=>(console.log(\"Opening device...\"),e=t,this.device=e,t.open()))).then((()=>(console.log(\"Selecting configuration\"),e.selectConfiguration(1)))).then((()=>{console.log(\"Getting endpoints\"),this.getEndpoints(e.configuration.interfaces)})).then((()=>(console.log(\"Claiming interface\"),e.claimInterface(this.ifNum)))).then((()=>(console.log(\"Select alt interface\"),e.selectAlternateInterface(this.ifNum,0)))).then((()=>(console.log(\"Control Transfer Out\"),e.controlTransferOut({requestType:\"class\",recipient:\"interface\",request:34,value:1,index:this.ifNum})))).then((()=>{console.log(\"Ready!\"),this.ready=!0,this.device=e,t()}))}))}read(e){return new Promise(((t,s)=>{this.device.transferIn(this.epIn,e).then((e=>{t(e)}),(e=>{console.log(\"Error\"),console.log(e),s(e)}))}))}readHex(e){return new Promise(((t,s)=>{this.read(e).then((e=>{var s;console.log(\"RES\"),console.log(e.data.buffer),t((s=e.data.buffer,[...new Uint8Array(s)].map((e=>e.toString(16).padStart(2,\"0\"))).join(\"\")))}),(e=>{s(e)}))}))}readString(){this.device.transferIn(this.epIn,64).then((e=>(console.log(\"ReadResult\"),console.log(e),(new TextDecoder).decode(e.data))),(e=>{console.log(\"ReadError\"),console.log(e)}))}sendString(e){return this.send(new TextEncoder(\"utf-8\").encode(e))}sendHex(e){return this.send(n(e))}send(e){return this.device.transferOut(this.epOut,e)}bufSendFunction(){if(this.send_active=!0,0!==this.buffer.length){var e=this.buffer.shift(),t=e[0],s=e[1];this.send(t).then((()=>{setTimeout((()=>{this.bufSendFunction()}),s)}))}else this.send_active=!1}bufSend(e,t){this.buffer.push([e,t]),this.send_active||this.bufSendFunction()}bufSendHex(e,t){var s=n(e);this.bufSend(s,t)}receiveFromOtherGB(e){this.buffer_in.push(e)}receiveFromMyGB(){this.device.transferIn(this.epIn,64).then((e=>{this.buffer_out.push(e.data)}))}sendToMyGB(){this.buffer_in.length>0&&this.device.controleTransferOut(this.epOut,this.buffer_in.pop())}}},18:function(e,t,s){\"use strict\";s.r(t),function(e){var t=s(8),n=s.n(t),o=s(15),i=s.n(o),a=(s(23),s(14),s(25),s(26),s(17)),r=s(13),c=s(6);e.jQuery=s(12),s(14);class h extends n.a.Component{constructor(e){super(e),console.log(\"Component init...\"),console.log(\"Set State to 0\"),this.state=0,this.master=1,this.gbdatain=\"None\",this.gbdataout=\"None\",console.log(\"Creating GBWebsocket ...\"),this.ws=new a.a.connect(\"https://127.0.0.1:8080\")}handleC(){console.log(\"Click create\"),console.log(\"Creating serial ...\"),this.serial=new r.a,console.log(\"Initializing websocket gymnastic ! (onmessage function)\"),console.log(\"Getting device ...\"),this.serial.getDevice().then((()=>{this.state=1,console.log(\"Usb connected, updating status.\"),this.connectionMaster()})).catch((e=>{console.log(\"CATTTCH \"+e)}))}handleJ(){console.log(\"Click create\"),console.log(\"Creating serial ...\"),this.serial=new r.a,console.log(\"Initializing websocket gymnastic ! (onmessage function)\"),console.log(\"Getting device ...\"),this.serial.getDevice().then((()=>{this.state=1,console.log(\"Usb connected, updating status.\"),this.master=0,this.connectionNotMaster()})).catch((e=>{console.log(\"CATTTCH \"+e)}))}connectionNotMaster(){let e=0;console.log(\"Wait for receiving first message ...\"),this.setState({state:1}),this.ws.on(\"message\",((t,s)=>{console.log(\"Got message \"+t+\" from \"+s),this.gbdatain=t,this.setState({gbdatain:t}),console.log(\"Communicating to my GB ...\"),this.serial.sendHex(this.gbdatain),this.ws.auth.serverOffset=s;this.ws.id,e++;this.gbdataout=this.serial.readHex(),this.setState({gbdataout:this.gbdataout}),console.log(\"Sending to other GB \"+this.gbdataout+\" from my GB...\"),this.ws.emit(\"message\",{text:JSON.parse(this.gbdataout),name:\"GB\"+this.ws.id,id:this.ws.id+\"\"+Math.random(),socketID:this.ws.id}),console.log(\"Exchange \"+e+\" : OK.\")}))}connectionMaster(){let e=0;console.log(\"Initiatting my first message ...\");this.ws.id,e++;this.gbdataout=this.serial.readHex(),this.setState({gbdataout:this.gbdataout,state:1}),console.log(\"Sending to other GB \"+this.gbdataout+\" from my GB...\"),this.ws.emit(\"message\",{text:JSON.parse(this.gbdataout),name:\"GB\"+this.ws.id,id:this.ws.id+\"\"+Math.random(),socketID:this.ws.id}),console.log(\"First Exchange : OK.\"),this.ws.on(\"message\",((t,s)=>{console.log(\"Got message \"+t+\" from \"+s),this.gbdatain=t,this.setState({gbdatain:t}),console.log(\"Communicating to my GB ...\"),this.serial.sendHex(this.gbdatain),this.ws.auth.serverOffset=s;this.ws.id,e++;this.gbdataout=this.serial.readHex(),this.setState({gbdataout:this.gbdataout}),console.log(\"Sending to other GB \"+this.gbdataout+\" from my GB...\"),this.ws.emit(\"message\",{text:JSON.parse(this.gbdataout),name:\"GB\"+this.ws.id,id:this.ws.id+\"\"+Math.random(),socketID:this.ws.id}),console.log(\"Exchange \"+e+\" : OK.\")}))}render(){return 0===this.state?Object(c.jsxs)(\"div\",{className:\"connect\",children:[Object(c.jsx)(\"button\",{onClick:e=>this.handleC(),className:\"btn btn-lg btn-secondary\",children:\"Host (Master)\"}),Object(c.jsx)(\"br\",{}),Object(c.jsx)(\"button\",{onClick:e=>this.handleJ(),className:\"btn btn-lg btn-secondary\",children:\"Connect (Client)\"})]}):1===this.state?Object(c.jsx)(\"div\",{className:\"connect\",children:Object(c.jsxs)(\"h4\",{children:[\"Connected => IN \",this.gbdatain.toString(),\" OUT \",this.gbdataout.toString()]})}):void 0}}i.a.render(Object(c.jsx)(h,{}),document.getElementById(\"root\"))}.call(this,s(7))},26:function(e,t,s){}},[[18,1,2]]]);","name":"static/js/main.96d59f00.chunk.js","map":{"version":3,"names":["this","push","module","__webpack_exports__","__webpack_require__","d","Serial","fromHexString","hexString","Uint8Array","match","map","byte","parseInt","constructor","buffer","buffer_in","buffer_out","send_active","getPorts","navigator","usb","getDevices","then","devices","requestPort","requestDevice","filters","vendorId","device","getEndpoints","interfaces","forEach","element","alternates","elementalt","interfaceClass","console","log","interfaceNumber","ifNum","endpoints","elementendpoint","direction","endpointNumber","epOut","epIn","getDevice","ready","Promise","resolve","reject","dev","open","selectConfiguration","configuration","claimInterface","selectAlternateInterface","controlTransferOut","requestType","recipient","request","value","index","read","num","transferIn","result","error","readHex","data","x","toString","padStart","join","readString","TextDecoder","decode","sendString","str","send","TextEncoder","encode","sendHex","transferOut","bufSendFunction","length","shift","delay","setTimeout","bufSend","bufSendHex","receiveFromOtherGB","receiveFromMyGB","sendToMyGB","controleTransferOut","pop","r","global","react__WEBPACK_IMPORTED_MODULE_0__","react__WEBPACK_IMPORTED_MODULE_0___default","n","react_dom__WEBPACK_IMPORTED_MODULE_1__","react_dom__WEBPACK_IMPORTED_MODULE_1___default","socket_io_client__WEBPACK_IMPORTED_MODULE_6__","_serial_js__WEBPACK_IMPORTED_MODULE_7__","react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__","jQuery","OnlineGBGame","a","Component","props","super","state","master","gbdatain","gbdataout","ws","connect","handleC","serial","connectionMaster","catch","c","handleJ","connectionNotMaster","counter","setState","on","msg","serverOffset","auth","id","emit","text","JSON","parse","name","Math","random","socketID","render","Object","className","children","onClick","e","document","getElementById","call","exports"],"sources":["static/js/main.96d59f00.chunk.js"],"mappings":"CAACA,KAAK,4BAA8BA,KAAK,6BAA+B,IAAIC,KAAK,CAAC,CAAC,GAAG,CAEhF,GACA,SAAUC,EAAQC,EAAqBC,GAE7C,aAC+BA,EAAoBC,EAAEF,EAAqB,KAAK,WAAa,OAAOG,CAAQ,IAC3G,MAAMC,EAAcC,GAAW,IAAIC,WAAWD,EAAUE,MAAM,WAAWC,KAAIC,GAAMC,SAASD,EAAK,OAC8E,MAAMN,EAAO,WAAAQ,GAAcd,KAAKe,OAAO,GAAGf,KAAKgB,UAAU,GAAGhB,KAAKiB,WAAW,GAAGjB,KAAKkB,aAAY,CAAM,CAAC,eAAOC,GAAW,OAAOC,UAAUC,IAAIC,aAAaC,MAAKC,GAAiBA,GAAW,CAAC,kBAAOC,GAEjX,OAAOL,UAAUC,IAAIK,cAAc,CAACC,QAFyW,CAAC,CAACC,SAAW,MAC5Z,CAACA,SAAW,UAC8CL,MAAKM,GAAgBA,GAAU,CAAC,YAAAC,CAAaC,GAAYA,EAAWC,SAAQC,IAAyBA,EAAQC,WAAsBF,SAAQG,IAA4C,MAA5BA,EAAWC,iBAAuBC,QAAQC,IAAI,qBAAqBD,QAAQC,IAAIL,EAAQM,iBAAiBvC,KAAKwC,MAAMP,EAAQM,gBAAgBJ,EAAWM,UAAUT,SAAQU,IAAiD,QAA5BA,EAAgBC,YAAmBN,QAAQC,IAAI,kBAAkBD,QAAQC,IAAII,EAAgBE,gBAAgB5C,KAAK6C,MAAMH,EAAgBE,gBAA+C,OAA5BF,EAAgBC,YAAkBN,QAAQC,IAAI,iBAAiBD,QAAQC,IAAII,EAAgBE,gBAAgB5C,KAAK8C,KAAKJ,EAAgBE,eAAe,IAAI,GAAG,GAAI,CAAC,SAAAG,GAAY,IAAIlB,EAAO,KAAsB,OAAjB7B,KAAKgD,OAAM,EAAa,IAAIC,SAAQ,CAACC,EAAQC,KAAU7C,EAAOmB,cAAcF,MAAK6B,IAAMf,QAAQC,IAAI,qBAAqBT,EAAOuB,EAAIpD,KAAK6B,OAAOA,EAAcuB,EAAIC,UAAU9B,MAAK,KAAKc,QAAQC,IAAI,2BAAkCT,EAAOyB,oBAAoB,MAAM/B,MAAK,KAAKc,QAAQC,IAAI,qBAAqBtC,KAAK8B,aAAaD,EAAO0B,cAAcxB,WAAW,IAAIR,MAAK,KAAKc,QAAQC,IAAI,sBAA6BT,EAAO2B,eAAexD,KAAKwC,UAAUjB,MAAK,KAAKc,QAAQC,IAAI,wBAA+BT,EAAO4B,yBAAyBzD,KAAKwC,MAAM,MAAMjB,MAAK,KAAKc,QAAQC,IAAI,wBAA+BT,EAAO6B,mBAAmB,CAACC,YAAc,QAAQC,UAAY,YAAYC,QAAU,GAAKC,MAAQ,EAAKC,MAAQ/D,KAAKwC,WAAWjB,MAAK,KAAKc,QAAQC,IAAI,UAAUtC,KAAKgD,OAAM,EAAKhD,KAAK6B,OAAOA,EAAOqB,GAAS,GAAG,GAAI,CAAC,IAAAc,CAAKC,GAAK,OAAO,IAAIhB,SAAQ,CAACC,EAAQC,KAAUnD,KAAK6B,OAAOqC,WAAWlE,KAAK8C,KAAKmB,GAAK1C,MAAK4C,IAASjB,EAAQiB,EAAO,IAAGC,IAAQ/B,QAAQC,IAAI,SAASD,QAAQC,IAAI8B,GAAOjB,EAAOiB,EAAM,GAAG,GAAI,CAAC,OAAAC,CAAQJ,GAAK,OAAO,IAAIhB,SAAQ,CAACC,EAAQC,KAAUnD,KAAKgE,KAAKC,GAAK1C,MAAK4C,IAH7qD,IAAiBpD,EAGqqDsB,QAAQC,IAAI,OAAOD,QAAQC,IAAI6B,EAAOG,KAAKvD,QAAQmC,GAHxtDnC,EAGwuDoD,EAAOG,KAAKvD,OAFt2D,IAAI,IAAIN,WAAWM,IAASJ,KAAI4D,GAAGA,EAAEC,SAAS,IAAIC,SAAS,EAAE,OAAMC,KAAK,KAEsyD,IAAGN,IAAQjB,EAAOiB,EAAM,GAAG,GAAI,CAAC,UAAAO,GAAa3E,KAAK6B,OAAOqC,WAAWlE,KAAK8C,KAAK,IAAIvB,MAAK4C,IAAS9B,QAAQC,IAAI,cAAcD,QAAQC,IAAI6B,IAAwB,IAAIS,aAAiCC,OAAOV,EAAOG,SAAQF,IAAQ/B,QAAQC,IAAI,aAAaD,QAAQC,IAAI8B,EAAM,GAAI,CAAC,UAAAU,CAAWC,GAAK,OAAO/E,KAAKgF,KAAK,IAAIC,YAAY,SAASC,OAAOH,GAAM,CAAC,OAAAI,CAAQJ,GAAK,OAAO/E,KAAKgF,KAAKzE,EAAcwE,GAAM,CAAC,IAAAC,CAAKV,GAAM,OAAOtE,KAAK6B,OAAOuD,YAAYpF,KAAK6C,MAAMyB,EAAM,CAAC,eAAAe,GAAwC,GAAtBrF,KAAKkB,aAAY,EAA6B,IAArBlB,KAAKe,OAAOuE,OAAf,CAA0D,IAAIrD,EAAQjC,KAAKe,OAAOwE,QAAYjB,EAAKrC,EAAQ,GAAOuD,EAAMvD,EAAQ,GAAGjC,KAAKgF,KAAKV,GAAM/C,MAAK,KAAKkE,YAAW,KAAKzF,KAAKqF,iBAAiB,GAAGG,EAAM,GAAnJ,MAA9BxF,KAAKkB,aAAY,CAAoK,CAAC,OAAAwE,CAAQpB,EAAKkB,GAAOxF,KAAKe,OAAOd,KAAK,CAACqE,EAAKkB,IAC5lFxF,KAAKkB,aAAalB,KAAKqF,iBAAmB,CAAC,UAAAM,CAAWZ,EAAIS,GAAO,IAAIlB,EAAK/D,EAAcwE,GAAK/E,KAAK0F,QAAQpB,EAAKkB,EAAO,CAAC,kBAAAI,CAAmBtB,GAAMtE,KAAKgB,UAAUf,KAAKqE,EAAM,CAAC,eAAAuB,GAAkB7F,KAAK6B,OAAOqC,WAAWlE,KAAK8C,KAAK,IAAIvB,MAAK4C,IAASnE,KAAKiB,WAAWhB,KAAKkE,EAAOG,KAAK,GAAI,CAAC,UAAAwB,GAAgB9F,KAAKgB,UAAUsE,OAAO,GAAEtF,KAAK6B,OAAOkE,oBAAoB/F,KAAK6C,MAAM7C,KAAKgB,UAAUgF,MAAO,EAE5X,EAED,GACA,SAAU9F,EAAQC,EAAqBC,GAE7C,aACAA,EAAoB6F,EAAE9F,GACM,SAAS+F,GAA8B,IAAIC,EAAqC/F,EAAoB,GACvGgG,EAA0DhG,EAAoBiG,EAAEF,GAChFG,EAAyClG,EAAoB,IAC7DmG,EAA8DnG,EAAoBiG,EAAEC,GASpFE,GARoEpG,EAAoB,IAE1BA,EAAoB,IAEhBA,EAAoB,IAE5CA,EAAoB,IAEdA,EAAoB,KACpEqG,EAA0CrG,EAAoB,IAC9DsG,EAAiDtG,EAAoB,GAE9F8F,EAAOS,OAAOvG,EAAoB,IAAIA,EAAoB,IAAiC,MAAMwG,UAAqBR,EAA2CS,EAAEC,UAAU,WAAAhG,CAAYiG,GAAOC,MAAMD,GAAO1E,QAAQC,IAAI,qBAAqBD,QAAQC,IAAI,kBAAkBtC,KAAKiH,MAAM,EAAEjH,KAAKkH,OAAO,EAAElH,KAAKmH,SAAS,OAAOnH,KAAKoH,UAAU,OAAO/E,QAAQC,IAAI,4BAA4BtC,KAAKqH,GAAG,IAAIb,EAA+D,EAAEc,QAAQ,yBAA+B,CAAC,OAAAC,GAC/elF,QAAQC,IAAI,gBAAgBD,QAAQC,IAAI,uBAAuBtC,KAAKwH,OAAO,IAAIf,EAAwD,EAAIpE,QAAQC,IAAI,2DAA2DD,QAAQC,IAAI,sBAAsBtC,KAAKwH,OAAOzE,YAAYxB,MAAK,KAAKvB,KAAKiH,MAAM,EAAE5E,QAAQC,IAAI,mCAAmCtC,KAAKyH,kBAAkB,IAAIC,OAAMC,IAAItF,QAAQC,IAAI,WAAWqF,EAAE,GAAI,CAAC,OAAAC,GACrZvF,QAAQC,IAAI,gBAAgBD,QAAQC,IAAI,uBAAuBtC,KAAKwH,OAAO,IAAIf,EAAwD,EAAIpE,QAAQC,IAAI,2DAA2DD,QAAQC,IAAI,sBAAsBtC,KAAKwH,OAAOzE,YAAYxB,MAAK,KAAKvB,KAAKiH,MAAM,EAAE5E,QAAQC,IAAI,mCAAmCtC,KAAKkH,OAAO,EAAElH,KAAK6H,qBAAqB,IAAIH,OAAMC,IAAItF,QAAQC,IAAI,WAAWqF,EAAE,GAAI,CAAC,mBAAAE,GAAsB,IAAIC,EAAQ,EAAEzF,QAAQC,IAAI,wCAAwCtC,KAAK+H,SAAS,CAACd,MAAM,IAAIjH,KAAKqH,GAAGW,GAAG,WAAU,CAACC,EAAIC,KAAgB7F,QAAQC,IAAI,eAAe2F,EAAI,SAASC,GAAclI,KAAKmH,SAASc,EAAIjI,KAAK+H,SAAS,CAACZ,SAASc,IAAM5F,QAAQC,IAAI,8BAA8BtC,KAAKwH,OAAOrC,QAAQnF,KAAKmH,UAAUnH,KAAKqH,GAAGc,KAAKD,aAAaA,EAA8BlI,KAAKqH,GAAGe,GAAON,IAAU9H,KAAKoH,UAAUpH,KAAKwH,OAAOnD,UAAUrE,KAAK+H,SAAS,CAACX,UAAUpH,KAAKoH,YAAY/E,QAAQC,IAAI,uBAAuBtC,KAAKoH,UAAU,kBAAkBpH,KAAKqH,GAAGgB,KAAK,UAAU,CAACC,KAAKC,KAAKC,MAAMxI,KAAKoH,WAAWqB,KAAK,KAAKzI,KAAKqH,GAAGe,GAAGA,GAAGpI,KAAKqH,GAAGe,GAAG,GAAGM,KAAKC,SAASC,SAAS5I,KAAKqH,GAAGe,KAAK/F,QAAQC,IAAI,YAAYwF,EAAQ,SAAS,GAAI,CAAC,gBAAAL,GAAmB,IAAIK,EAAQ,EAAEzF,QAAQC,IAAI,oCAAqDtC,KAAKqH,GAAGe,GAAON,IAAU9H,KAAKoH,UAAUpH,KAAKwH,OAAOnD,UAAUrE,KAAK+H,SAAS,CAACX,UAAUpH,KAAKoH,UAAUH,MAAM,IAAI5E,QAAQC,IAAI,uBAAuBtC,KAAKoH,UAAU,kBAAkBpH,KAAKqH,GAAGgB,KAAK,UAAU,CAACC,KAAKC,KAAKC,MAAMxI,KAAKoH,WAAWqB,KAAK,KAAKzI,KAAKqH,GAAGe,GAAGA,GAAGpI,KAAKqH,GAAGe,GAAG,GAAGM,KAAKC,SAASC,SAAS5I,KAAKqH,GAAGe,KAAK/F,QAAQC,IAAI,wBAAwBtC,KAAKqH,GAAGW,GAAG,WAAU,CAACC,EAAIC,KAAgB7F,QAAQC,IAAI,eAAe2F,EAAI,SAASC,GAAclI,KAAKmH,SAASc,EAAIjI,KAAK+H,SAAS,CAACZ,SAASc,IAAM5F,QAAQC,IAAI,8BAA8BtC,KAAKwH,OAAOrC,QAAQnF,KAAKmH,UAAUnH,KAAKqH,GAAGc,KAAKD,aAAaA,EAA8BlI,KAAKqH,GAAGe,GAAON,IAAU9H,KAAKoH,UAAUpH,KAAKwH,OAAOnD,UAAUrE,KAAK+H,SAAS,CAACX,UAAUpH,KAAKoH,YAAY/E,QAAQC,IAAI,uBAAuBtC,KAAKoH,UAAU,kBAAkBpH,KAAKqH,GAAGgB,KAAK,UAAU,CAACC,KAAKC,KAAKC,MAAMxI,KAAKoH,WAAWqB,KAAK,KAAKzI,KAAKqH,GAAGe,GAAGA,GAAGpI,KAAKqH,GAAGe,GAAG,GAAGM,KAAKC,SAASC,SAAS5I,KAAKqH,GAAGe,KAAK/F,QAAQC,IAAI,YAAYwF,EAAQ,SAAS,GAAI,CAAC,MAAAe,GAAS,OAAgB,IAAb7I,KAAKiH,MAA6B6B,OAAOpC,EAAqD,KAA5DoC,CAA+D,MAAM,CAACC,UAAU,UAAUC,SAAS,CAAcF,OAAOpC,EAAoD,IAA3DoC,CAA8D,SAAS,CAACG,QAAQC,GAAGlJ,KAAKuH,UAAUwB,UAAU,2BAA2BC,SAAS,kBAA+BF,OAAOpC,EAAoD,IAA3DoC,CAA8D,KAAK,CAAC,GAAgBA,OAAOpC,EAAoD,IAA3DoC,CAA8D,SAAS,CAACG,QAAQC,GAAGlJ,KAAK4H,UAAUmB,UAAU,2BAA2BC,SAAS,wBAA6C,IAAbhJ,KAAKiH,MAA6B6B,OAAOpC,EAAoD,IAA3DoC,CAA8D,MAAM,CAACC,UAAU,UAAUC,SAAsBF,OAAOpC,EAAqD,KAA5DoC,CAA+D,KAAK,CAACE,SAAS,CAAC,mBAAmBhJ,KAAKmH,SAAS3C,WAAW,QAAQxE,KAAKoH,UAAU5C,qBAAtS,CAAsT,EAC1jG+B,EAA+CM,EAAEgC,OAAoBC,OAAOpC,EAAoD,IAA3DoC,CAA8DlC,EAAa,CAAC,GAAGuC,SAASC,eAAe,QACjJ,EAAEC,KAAKrJ,KAAMI,EAAoB,GAErD,EAED,GACA,SAAUF,EAAQoJ,EAASlJ,GAI1B,GAEL,CAAC,CAAC,GAAG,EAAE","ignoreList":[]},"input":"(this[\"webpackJsonpgb-relay-web\"] = this[\"webpackJsonpgb-relay-web\"] || []).push([[0],{\n\n/***/ 13:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return Serial; });\nconst fromHexString=hexString=>new Uint8Array(hexString.match(/.{1,2}/g).map(byte=>parseInt(byte,16)));function buf2hex(buffer){// buffer is an ArrayBuffer\nreturn[...new Uint8Array(buffer)].map(x=>x.toString(16).padStart(2,'0')).join('');}const toHexString=bytes=>bytes.reduce((str,byte)=>str+byte.toString(16).padStart(2,'0'),'');class Serial{constructor(){this.buffer=[];this.buffer_in=[];this.buffer_out=[];this.send_active=false;}static getPorts(){return navigator.usb.getDevices().then(devices=>{return devices;});}static requestPort(){const filters=[{'vendorId':0x239A},// Adafruit boards\n{'vendorId':0xcafe}// TinyUSB example\n];return navigator.usb.requestDevice({'filters':filters}).then(device=>{return device;});}getEndpoints(interfaces){interfaces.forEach(element=>{var alternates=element.alternates;alternates.forEach(elementalt=>{if(elementalt.interfaceClass===0xFF){console.log(\"Interface number:\");console.log(element.interfaceNumber);this.ifNum=element.interfaceNumber;elementalt.endpoints.forEach(elementendpoint=>{if(elementendpoint.direction===\"out\"){console.log(\"Endpoint out: \");console.log(elementendpoint.endpointNumber);this.epOut=elementendpoint.endpointNumber;}if(elementendpoint.direction===\"in\"){console.log(\"Endpoint in: \");console.log(elementendpoint.endpointNumber);this.epIn=elementendpoint.endpointNumber;}});}});});}getDevice(){let device=null;this.ready=false;return new Promise((resolve,reject)=>{Serial.requestPort().then(dev=>{console.log(\"Opening device...\");device=dev;this.device=device;return dev.open();}).then(()=>{console.log(\"Selecting configuration\");return device.selectConfiguration(1);}).then(()=>{console.log(\"Getting endpoints\");this.getEndpoints(device.configuration.interfaces);}).then(()=>{console.log(\"Claiming interface\");return device.claimInterface(this.ifNum);}).then(()=>{console.log(\"Select alt interface\");return device.selectAlternateInterface(this.ifNum,0);}).then(()=>{console.log(\"Control Transfer Out\");return device.controlTransferOut({'requestType':'class','recipient':'interface','request':0x22,'value':0x01,'index':this.ifNum});}).then(()=>{console.log(\"Ready!\");this.ready=true;this.device=device;resolve();});});}read(num){return new Promise((resolve,reject)=>{this.device.transferIn(this.epIn,num).then(result=>{resolve(result);},error=>{console.log(\"Error\");console.log(error);reject(error);});});}readHex(num){return new Promise((resolve,reject)=>{this.read(num).then(result=>{console.log(\"RES\");console.log(result.data.buffer);resolve(buf2hex(result.data.buffer));},error=>{reject(error);});});}readString(){this.device.transferIn(this.epIn,64).then(result=>{console.log(\"ReadResult\");console.log(result);let textDecoder=new TextDecoder();return textDecoder.decode(result.data);},error=>{console.log(\"ReadError\");console.log(error);});}sendString(str){return this.send(new TextEncoder('utf-8').encode(str));}sendHex(str){return this.send(fromHexString(str));}send(data){return this.device.transferOut(this.epOut,data);}bufSendFunction(){this.send_active=true;if(this.buffer.length===0){this.send_active=false;return;}var element=this.buffer.shift();var data=element[0];var delay=element[1];this.send(data).then(()=>{setTimeout(()=>{this.bufSendFunction();},delay);});}bufSend(data,delay){this.buffer.push([data,delay]);// Sender is not active, create new one\nif(!this.send_active){this.bufSendFunction();}}bufSendHex(str,delay){var data=fromHexString(str);this.bufSend(data,delay);}receiveFromOtherGB(data){this.buffer_in.push(data);}receiveFromMyGB(){this.device.transferIn(this.epIn,64).then(result=>{this.buffer_out.push(result.data);});}sendToMyGB(){if(this.buffer_in.length>0)this.device.controleTransferOut(this.epOut,this.buffer_in.pop());}}\n\n/***/ }),\n\n/***/ 18:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n__webpack_require__.r(__webpack_exports__);\n/* WEBPACK VAR INJECTION */(function(global) {/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(8);\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var react_dom__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(15);\n/* harmony import */ var react_dom__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react_dom__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var bootstrap_dist_css_bootstrap_min_css__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(23);\n/* harmony import */ var bootstrap_dist_css_bootstrap_min_css__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(bootstrap_dist_css_bootstrap_min_css__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var bootstrap_dist_js_bootstrap_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(14);\n/* harmony import */ var bootstrap_dist_js_bootstrap_js__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(bootstrap_dist_js_bootstrap_js__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var bootstrap_dist_js_bootstrap_bundle__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(25);\n/* harmony import */ var bootstrap_dist_js_bootstrap_bundle__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(bootstrap_dist_js_bootstrap_bundle__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var _index_css__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(26);\n/* harmony import */ var _index_css__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(_index_css__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var socket_io_client__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(17);\n/* harmony import */ var _serial_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(13);\n/* harmony import */ var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(6);\n/* harmony import */ var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8___default = /*#__PURE__*/__webpack_require__.n(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__);\nglobal.jQuery=__webpack_require__(12);__webpack_require__(14);const HOSTSTATIC=\"127.0.0.1\";class OnlineGBGame extends react__WEBPACK_IMPORTED_MODULE_0___default.a.Component{constructor(props){super(props);console.log(\"Component init...\");console.log(\"Set State to 0\");this.state=0;this.master=1;this.gbdatain=\"None\";this.gbdataout=\"None\";console.log(\"Creating GBWebsocket ...\");this.ws=new socket_io_client__WEBPACK_IMPORTED_MODULE_6__[/* default */ \"a\"].connect(\"https://\"+HOSTSTATIC+\":8080\");}handleC(){// Handle create (master mode)\nconsole.log('Click create');console.log(\"Creating serial ...\");this.serial=new _serial_js__WEBPACK_IMPORTED_MODULE_7__[/* Serial */ \"a\"]();console.log(\"Initializing websocket gymnastic ! (onmessage function)\");console.log(\"Getting device ...\");this.serial.getDevice().then(()=>{this.state=1;console.log(\"Usb connected, updating status.\");this.connectionMaster();}).catch(c=>{console.log(\"CATTTCH \"+c);});}handleJ(){// Handle Join (master mode off)\nconsole.log('Click create');console.log(\"Creating serial ...\");this.serial=new _serial_js__WEBPACK_IMPORTED_MODULE_7__[/* Serial */ \"a\"]();console.log(\"Initializing websocket gymnastic ! (onmessage function)\");console.log(\"Getting device ...\");this.serial.getDevice().then(()=>{this.state=1;console.log(\"Usb connected, updating status.\");this.master=0;this.connectionNotMaster();}).catch(c=>{console.log(\"CATTTCH \"+c);});}connectionNotMaster(){let counter=0;console.log(\"Wait for receiving first message ...\");this.setState({state:1});this.ws.on(\"message\",(msg,serverOffset)=>{console.log(\"Got message \"+msg+\" from \"+serverOffset);this.gbdatain=msg;this.setState({gbdatain:msg});console.log(\"Communicating to my GB ...\");this.serial.sendHex(this.gbdatain);this.ws.auth.serverOffset=serverOffset;var clientOffset=this.ws.id+\"-\"+counter++;this.gbdataout=this.serial.readHex();this.setState({gbdataout:this.gbdataout});console.log(\"Sending to other GB \"+this.gbdataout+\" from my GB...\");this.ws.emit('message',{text:JSON.parse(this.gbdataout),name:'GB'+this.ws.id,id:this.ws.id+\"\"+Math.random(),socketID:this.ws.id});console.log(\"Exchange \"+counter+\" : OK.\");});}connectionMaster(){let counter=0;console.log(\"Initiatting my first message ...\");var clientOffset=this.ws.id+\"-\"+counter++;this.gbdataout=this.serial.readHex();this.setState({gbdataout:this.gbdataout,state:1});console.log(\"Sending to other GB \"+this.gbdataout+\" from my GB...\");this.ws.emit('message',{text:JSON.parse(this.gbdataout),name:'GB'+this.ws.id,id:this.ws.id+\"\"+Math.random(),socketID:this.ws.id});console.log(\"First Exchange : OK.\");this.ws.on(\"message\",(msg,serverOffset)=>{console.log(\"Got message \"+msg+\" from \"+serverOffset);this.gbdatain=msg;this.setState({gbdatain:msg});console.log(\"Communicating to my GB ...\");this.serial.sendHex(this.gbdatain);this.ws.auth.serverOffset=serverOffset;var clientOffset=this.ws.id+\"-\"+counter++;this.gbdataout=this.serial.readHex();this.setState({gbdataout:this.gbdataout});console.log(\"Sending to other GB \"+this.gbdataout+\" from my GB...\");this.ws.emit('message',{text:JSON.parse(this.gbdataout),name:'GB'+this.ws.id,id:this.ws.id+\"\"+Math.random(),socketID:this.ws.id});console.log(\"Exchange \"+counter+\" : OK.\");});}render(){if(this.state===0)return/*#__PURE__*/Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__[\"jsxs\"])(\"div\",{className:\"connect\",children:[/*#__PURE__*/Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__[\"jsx\"])(\"button\",{onClick:e=>this.handleC(),className:\"btn btn-lg btn-secondary\",children:\"Host (Master)\"}),/*#__PURE__*/Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__[\"jsx\"])(\"br\",{}),/*#__PURE__*/Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__[\"jsx\"])(\"button\",{onClick:e=>this.handleJ(),className:\"btn btn-lg btn-secondary\",children:\"Connect (Client)\"})]});else if(this.state===1)return/*#__PURE__*/Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__[\"jsx\"])(\"div\",{className:\"connect\",children:/*#__PURE__*/Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__[\"jsxs\"])(\"h4\",{children:[\"Connected => IN \",this.gbdatain.toString(),\" OUT \",this.gbdataout.toString()]})});}}// ========================================\nreact_dom__WEBPACK_IMPORTED_MODULE_1___default.a.render(/*#__PURE__*/Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__[\"jsx\"])(OnlineGBGame,{}),document.getElementById('root'));\n/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(7)))\n\n/***/ }),\n\n/***/ 26:\n/***/ (function(module, exports, __webpack_require__) {\n\n// extracted by mini-css-extract-plugin\n\n/***/ })\n\n},[[18,1,2]]]);","inputSourceMap":{"version":3,"sources":["/home/kali/Project/GameBoyRelay/GBRelay/WebInterface/src/serial.js","/home/kali/Project/GameBoyRelay/GBRelay/WebInterface/src/index.js","/home/kali/Project/GameBoyRelay/GBRelay/WebInterface/node_modules/mini-css-extract-plugin/dist/loader.js??ref--5-oneOf-4-0!/home/kali/Project/GameBoyRelay/GBRelay/WebInterface/node_modules/css-loader/dist/cjs.js??ref--5-oneOf-4-1!/home/kali/Project/GameBoyRelay/GBRelay/WebInterface/node_modules/postcss-loader/src/index.js??postcss!/home/kali/Project/GameBoyRelay/GBRelay/WebInterface/src/index.css"],"names":["fromHexString","hexString","Uint8Array","match","map","byte","parseInt","buf2hex","buffer","x","toString","padStart","join","toHexString","bytes","reduce","str","Serial","constructor","buffer_in","buffer_out","send_active","getPorts","navigator","usb","getDevices","then","devices","requestPort","filters","requestDevice","device","getEndpoints","interfaces","forEach","element","alternates","elementalt","interfaceClass","console","log","interfaceNumber","ifNum","endpoints","elementendpoint","direction","endpointNumber","epOut","epIn","getDevice","ready","Promise","resolve","reject","dev","open","selectConfiguration","configuration","claimInterface","selectAlternateInterface","controlTransferOut","read","num","transferIn","result","error","readHex","data","readString","textDecoder","TextDecoder","decode","sendString","send","TextEncoder","encode","sendHex","transferOut","bufSendFunction","length","shift","delay","setTimeout","bufSend","push","bufSendHex","receiveFromOtherGB","receiveFromMyGB","sendToMyGB","controleTransferOut","pop","global","jQuery","require","HOSTSTATIC","OnlineGBGame","React","Component","props","state","master","gbdatain","gbdataout","ws","SocketIO","connect","handleC","serial","connectionMaster","catch","c","handleJ","connectionNotMaster","counter","setState","on","msg","serverOffset","auth","clientOffset","id","emit","text","JSON","parse","name","Math","random","socketID","render","_jsxs","className","children","_jsx","onClick","e","ReactDOM","document","getElementById"],"mappings":"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","file":"x","sourcesContent":["\nconst fromHexString = hexString =>\n    new Uint8Array(hexString.match(/.{1,2}/g).map(byte => parseInt(byte, 16)));\n\n\n\nfunction buf2hex(buffer) { // buffer is an ArrayBuffer\n    return [...new Uint8Array(buffer)].map(x => x.toString(16).padStart(2, '0')).join('');\n  }\n  \nconst toHexString = bytes =>\n    bytes.reduce((str, byte) => str + byte.toString(16).padStart(2, '0'), '');\n\nclass Serial {\n    constructor() {\n        this.buffer = [];\n\tthis.buffer_in = [];\n        this.buffer_out = [];\n        this.send_active = false;\n\t\n    }\n\n    static getPorts() {\n        return navigator.usb.getDevices().then(devices => {\n            return devices;\n        });\n    }\n\n    static requestPort() {\n        const filters = [\n            { 'vendorId': 0x239A }, // Adafruit boards\n            { 'vendorId': 0xcafe }, // TinyUSB example\n        ];\n        return navigator.usb.requestDevice({ 'filters': filters }).then(\n            device => {\n                return device;\n            }\n        );\n    }\n\n    getEndpoints(interfaces) {\n        interfaces.forEach(element => {\n            var alternates = element.alternates;\n            alternates.forEach(elementalt => {\n                if (elementalt.interfaceClass === 0xFF) {\n                    console.log(\"Interface number:\");\n                    console.log(element.interfaceNumber);\n                    this.ifNum = element.interfaceNumber;\n                    elementalt.endpoints.forEach(elementendpoint => {\n                        if (elementendpoint.direction === \"out\") {\n                            console.log(\"Endpoint out: \");\n                            console.log(elementendpoint.endpointNumber);\n                            this.epOut = elementendpoint.endpointNumber;\n                        }\n\n                        if (elementendpoint.direction === \"in\") {\n                            console.log(\"Endpoint in: \");\n                            console.log(elementendpoint.endpointNumber);\n                            this.epIn = elementendpoint.endpointNumber;\n                        }\n                    });\n                }\n            })\n        })\n    }\n\n    getDevice() {\n        let device = null;\n        this.ready = false;\n        return new Promise((resolve, reject) => {\n            Serial.requestPort().then(dev => {\n                console.log(\"Opening device...\");\n                device = dev;\n                this.device = device;\n                return dev.open();\n            }).then(() => {\n                console.log(\"Selecting configuration\");\n                return device.selectConfiguration(1);\n            }).then(() => {\n                console.log(\"Getting endpoints\")\n                this.getEndpoints(device.configuration.interfaces);\n            }).then(() => {\n                console.log(\"Claiming interface\");\n                return device.claimInterface(this.ifNum);\n            }).then(() => {\n                console.log(\"Select alt interface\");\n                return device.selectAlternateInterface(this.ifNum, 0);\n            }).then(() => {\n                console.log(\"Control Transfer Out\");\n                return device.controlTransferOut({\n                    'requestType': 'class',\n                    'recipient': 'interface',\n                    'request': 0x22,\n                    'value': 0x01,\n                    'index': this.ifNum\n                })\n            }).then(() => {\n                console.log(\"Ready!\");\n                this.ready = true;\n                this.device = device;\n                resolve();\n            })\n        });\n    }\n\n    read(num) {\n        return new Promise((resolve, reject) => {\n            this.device.transferIn(this.epIn, num).then(result => {\n                resolve(result);\n            },\n            error => {\n                console.log(\"Error\");\n                console.log(error);\n                reject(error);\n            });\n        });\n    }\n\n    readHex(num) {\n        return new Promise((resolve, reject) => {\n            this.read(num).then(result => {\n                console.log(\"RES\");\n                console.log(result.data.buffer);\n                resolve(buf2hex(result.data.buffer));\n            },\n            error => {\n                reject(error);\n            })\n        });\n    }\n\n    readString() {\n        this.device.transferIn(this.epIn, 64).then(result => {\n            console.log(\"ReadResult\");\n            console.log(result);\n            let textDecoder = new TextDecoder();\n            return textDecoder.decode(result.data);\n        },\n            error => {\n                console.log(\"ReadError\");\n                console.log(error);\n            })\n    }\n\n    sendString(str) {\n        return this.send(new TextEncoder('utf-8').encode(str));\n    }\n\n    sendHex(str) {\n        return this.send(fromHexString(str));\n    }\n\n    send(data) {\n        return this.device.transferOut(this.epOut, data);\n    }\n\n    bufSendFunction() {\n        this.send_active = true;\n        if(this.buffer.length === 0) {\n            this.send_active = false;\n            return;\n        }\n        var element = this.buffer.shift();\n        var data = element[0];\n        var delay = element[1];\n        this.send(data).then(() => {\n            setTimeout(() => {\n                this.bufSendFunction();\n            }, delay);\n        });\n    }\n\n    bufSend(data, delay) {\n        this.buffer.push([data, delay]);\n        // Sender is not active, create new one\n        if(!this.send_active) {\n            this.bufSendFunction();\n        }\n    }\n\n    bufSendHex(str, delay) {\n        var data = fromHexString(str);\n        this.bufSend(data, delay);\n    }\n\n    receiveFromOtherGB(data) {\n        this.buffer_in.push(data);\n    }\n\n    receiveFromMyGB()\n    {\n            this.device.transferIn(this.epIn, 64).then(result => {\n               this.buffer_out.push(result.data);\n            });\n    }\n\n    sendToMyGB() {\n        if(this.buffer_in.length > 0)\n                this.device.controleTransferOut(this.epOut, this.buffer_in.pop());\n    }\n}\n\nexport { Serial };\n","import React from 'react';\nimport ReactDOM from 'react-dom';\n\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport 'bootstrap/dist/js/bootstrap.js';\nimport 'bootstrap/dist/js/bootstrap.bundle';\nimport './index.css';\n\nimport SocketIO from 'socket.io-client';\nimport { Serial } from './serial.js';\nglobal.jQuery = require('jquery');\nrequire('bootstrap');\n\nconst HOSTSTATIC = \"127.0.0.1\"; \n\nclass OnlineGBGame extends React.Component {\n  constructor(props)\n  {\n   super(props);\n   console.log(\"Component init...\");\n   console.log(\"Set State to 0\");\n   this.state = 0;\n   this.master = 1;\n   this.gbdatain = \"None\";\n   this.gbdataout = \"None\";\n   console.log(\"Creating GBWebsocket ...\");\n   this.ws = new SocketIO.connect(\"https://\"+HOSTSTATIC+\":8080\");\n  }\n\n  handleC() { // Handle create (master mode)\n    console.log('Click create');\n      console.log(\"Creating serial ...\");\n      this.serial = new Serial();\n      console.log(\"Initializing websocket gymnastic ! (onmessage function)\");\n      console.log(\"Getting device ...\");\n      this.serial.getDevice().then(() => {\n        this.state = 1;\n        console.log(\"Usb connected, updating status.\");\n        this.connectionMaster();\n      }).catch(c => {\n        console.log(\"CATTTCH \"+c);\n      });\n  }\n  \n  handleJ() { // Handle Join (master mode off)\n   console.log('Click create');\n      console.log(\"Creating serial ...\");\n      this.serial = new Serial();\n      console.log(\"Initializing websocket gymnastic ! (onmessage function)\");\n      console.log(\"Getting device ...\");\n      this.serial.getDevice().then(() => {\n        this.state = 1;\n        console.log(\"Usb connected, updating status.\");\n        this.master = 0;\n\tthis.connectionNotMaster();\n      }).catch(c => {\n        console.log(\"CATTTCH \"+c);\n      });\n  }\n\n  connectionNotMaster()\n  {\n   \tlet counter = 0;\n        console.log(\"Wait for receiving first message ...\");\n        this.setState({\n                state: 1\n        });\n        this.ws.on(\"message\", (msg, serverOffset) => {\n                console.log(\"Got message \"+msg+\" from \"+serverOffset);\n                this.gbdatain = msg;\n                this.setState({\n                        gbdatain: msg\n                });\n                console.log(\"Communicating to my GB ...\");\n                this.serial.sendHex(this.gbdatain);\n                this.ws.auth.serverOffset = serverOffset;\n                var clientOffset = this.ws.id+\"-\"+(counter++);\n                this.gbdataout = this.serial.readHex();\n                this.setState({\n                        gbdataout: this.gbdataout\n                });\n                console.log(\"Sending to other GB \"+this.gbdataout+\" from my GB...\");\n                this.ws.emit('message', { text:JSON.parse(this.gbdataout), name: 'GB'+this.ws.id, id: this.ws.id+\"\"+Math.random(), socketID: this.ws.id});\n                console.log(\"Exchange \"+counter+\" : OK.\");\n        });\n  }\n\n  connectionMaster() {\n\tlet counter = 0;\n\tconsole.log(\"Initiatting my first message ...\");\n\tvar clientOffset = this.ws.id+\"-\"+(counter++);\n        this.gbdataout = this.serial.readHex();\n\tthis.setState({\n\t\tgbdataout: this.gbdataout,\n\t\tstate: 1\n\t});\n\tconsole.log(\"Sending to other GB \"+this.gbdataout+\" from my GB...\");\n\tthis.ws.emit('message', { text:JSON.parse(this.gbdataout), name: 'GB'+this.ws.id, id: this.ws.id+\"\"+Math.random(), socketID: this.ws.id});\n        console.log(\"First Exchange : OK.\");\n\tthis.ws.on(\"message\", (msg, serverOffset) => {\n\t\tconsole.log(\"Got message \"+msg+\" from \"+serverOffset);\n\t\tthis.gbdatain = msg;\n\t\tthis.setState({\n\t\t\tgbdatain: msg\n\t\t});\n\t\tconsole.log(\"Communicating to my GB ...\");\n\t\tthis.serial.sendHex(this.gbdatain);\n\t\tthis.ws.auth.serverOffset = serverOffset;\n\t\tvar clientOffset = this.ws.id+\"-\"+(counter++);\n\t\tthis.gbdataout = this.serial.readHex();\n\t\tthis.setState({\n\t\t\tgbdataout: this.gbdataout\n\t\t});\n\t\tconsole.log(\"Sending to other GB \"+this.gbdataout+\" from my GB...\");\n\t\tthis.ws.emit('message', { text:JSON.parse(this.gbdataout), name: 'GB'+this.ws.id, id: this.ws.id+\"\"+Math.random(), socketID: this.ws.id});\n\t\tconsole.log(\"Exchange \"+counter+\" : OK.\");\n\t});\n  }\n  \n  render() {\n\tif(this.state === 0)\n               return (\n          \t<div className=\"connect\">\n            \t\t<button onClick={(e) => this.handleC()} className=\"btn btn-lg btn-secondary\">Host (Master)</button><br/>\n            \t\t<button onClick={(e) => this.handleJ()} className=\"btn btn-lg btn-secondary\">Connect (Client)</button>\n          \t</div>\n               )\n       else if(this.state === 1)\n\t\treturn (\n                <div className=\"connect\">\n\t                <h4>Connected => IN { this.gbdatain.toString() } OUT { this.gbdataout.toString() }</h4>\n                </div>\n               )\n   }\n}\n\n// ========================================\n\nReactDOM.render(\n  <OnlineGBGame />,\n  document.getElementById('root')\n);\n","// extracted by mini-css-extract-plugin"]}}